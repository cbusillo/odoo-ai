fragment AddressFields on MailingAddress {
    id
    company
    name
    address1
    address2
    city
    provinceCode
    province
    countryCodeV2
    zip
    phone
}

fragment CustomerFields on Customer {
    id
    firstName
    lastName
    defaultEmailAddress {
        emailAddress
        marketingState
        marketingOptInLevel
        marketingUpdatedAt
    }
    defaultPhoneNumber {
        phoneNumber
        marketingState
        marketingOptInLevel
        marketingUpdatedAt
    }
    createdAt
    updatedAt
    defaultAddress { ...AddressFields }
    addressesV2(first: 50) { nodes { ...AddressFields } }
    tags
    taxExempt
}


query GetCustomers($cursor: String, $limit: Int!, $query: String) {
    customers(first: $limit, after: $cursor, query: $query, sortKey: UPDATED_AT) {
        pageInfo { hasNextPage endCursor }
        nodes  { ...CustomerFields }
    }
}