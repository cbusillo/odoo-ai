fragment OrderLineItemFields on LineItem {
    id
    sku
    quantity
    name
    variant {
        id
    }
    originalUnitPriceSet { ...MoneyBagFields }
    customAttributes { key value }
    discountAllocations { allocatedAmountSet { ...MoneyBagFields } }
}

fragment ShippingLineFields on ShippingLine {
    id
    title
    carrierIdentifier
    code
    originalPriceSet { ...MoneyBagFields }
    currentDiscountedPriceSet { ...MoneyBagFields }
    discountedPriceSet { ...MoneyBagFields }
    deliveryCategory
    isRemoved
}

fragment TaxLineFields on TaxLine {
    title
    ratePercentage
    priceSet { ...MoneyBagFields }
}

fragment OrderFields on Order {
    id
    name
    createdAt
    updatedAt
    processedAt
    closedAt
    cancelledAt
    currencyCode
    totalPriceSet      { ...MoneyBagFields }
    subtotalPriceSet   { ...MoneyBagFields }
    totalShippingPriceSet { ...MoneyBagFields }
    customer           { ...CustomerFields }
    shippingAddress    { ...AddressFields }
    billingAddress     { ...AddressFields }
    lineItems(first: 250) { nodes { ...OrderLineItemFields } }
    shippingLines(first: 10) { nodes { ...ShippingLineFields } }
    fulfillments { trackingInfo { ...FulfillmentTrackingInfoFields } }
    discountApplications(first: 1) { nodes { ...DiscountApplicationFields } }
    totalDiscountsSet { ...MoneyBagFields }
    taxLines { ...TaxLineFields }
    metafields(first: 15, namespace: "custom") { nodes { ...MetafieldFields } }
    note
    customAttributes { key value }
    paymentGatewayNames
}
fragment FulfillmentTrackingInfoFields on FulfillmentTrackingInfo {
    number
    url
    company
}

fragment DiscountApplicationFields on DiscountApplication {
    __typename
    ... on ManualDiscountApplication { title }
    ... on DiscountCodeApplication { code }
}

query GetOrderIds($cursor: String, $limit: Int!, $query: String) {
    orders(first: $limit, after: $cursor, query: $query, sortKey: UPDATED_AT) {
        pageInfo { hasNextPage endCursor }
        nodes    { id }
    }
}

query GetOrders($cursor: String, $limit: Int!, $query: String) {
    orders(first: $limit, after: $cursor, query: $query, sortKey: UPDATED_AT) {
        pageInfo { hasNextPage endCursor }
        nodes    { ...OrderFields }
    }
}